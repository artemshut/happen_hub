<h1 class="text-3xl font-bold mb-6">Your Friends</h1>

<h2 class="text-2xl font-semibold mb-4">Friends List</h2>
<ul class="list-disc pl-6 mb-6">
  <% @friends.each do |friend| %>
    <li class="mb-2">
      <span class="font-medium text-gray-700"><%= friend.first_name %> <%= friend.last_name %></span>
      (<span class="text-gray-500"><%= friend.tag %></span>)
    </li>
  <% end %>
</ul>

<h2 class="text-2xl font-semibold mb-4">Pending Friend Requests</h2>
<ul class="list-disc pl-6 mb-6">
  <% @pending_requests.each do |request| %>
    <li class="mb-2">
      <span class="font-medium text-gray-700"><%= request.user.first_name %> <%= request.user.last_name %></span>
      (<span class="text-gray-500"><%= request.user.tag %></span>)
      <div class="mt-2 flex space-x-2">
        <%= button_to 'Accept', friendship_path(request.user, status: 'accept'), method: :patch, class: "bg-accent-red text-white px-4 py-2 rounded hover:bg-red-600" %>
        <%= button_to 'Decline', friendship_path(request.user, status: 'decline'), method: :patch, class: "bg-gray-300 text-gray-700 px-4 py-2 rounded hover:bg-gray-400" %>
      </div>
    </li>
  <% end %>
</ul>

<h2 class="text-2xl font-semibold mb-4">Find Friends by Tag</h2>
<%= form_with url: friendships_path, method: :get, local: true, class: "space-y-4" do %>
  <div class="flex items-center space-x-4">
    <%= label_tag :query, 'Search by tag:', class: "font-medium text-gray-700" %>
    <%= text_field_tag :query, params[:query], class: "w-full border border-gray-300 rounded px-4 py-2 focus:ring-2 focus:ring-accent-red" %>
    <%= submit_tag 'Search', class: "bg-accent-red text-white px-4 py-2 rounded hover:bg-red-600" %>
  </div>
<% end %>

<% if params[:query].present? %>
  <h3 class="text-xl font-semibold mt-6">Search Results</h3>
  <ul class="list-disc pl-6">
    <% User.search_by_tag(params[:query]).each do |user| %>
      <li class="mb-2">
        <span class="font-medium text-gray-700"><%= user.first_name %> <%= user.last_name %></span>
        (<span class="text-gray-500"><%= user.tag %></span>)
        <%= button_to 'Add Friend', friendships_path(friend_id: user.id, status: 'accepted'), method: :post, class: "bg-accent-red text-white px-4 py-2 rounded hover:bg-red-600" %>
      </li>
    <% end %>
  </ul>
<% end %>

<h1>Friend Requests</h1>

<h2>Pending Requests</h2>
<% if @pending_requests.any? %>
  <ul>
    <% @pending_requests.each do |request| %>
      <li>
        <%= request.user.full_name %>
        <%= button_to "Accept", friendship_path(request, status: :accepted), method: :patch, class: "bg-green-500 text-white px-4 py-2 rounded hover:bg-green-600" %>
        <%= button_to "Decline", friendship_path(request, status: :declined), method: :patch, class: "bg-red-500 text-white px-4 py-2 rounded hover:bg-red-600" %>
      </li>
    <% end %>
  </ul>
<% else %>
  <p>No pending requests.</p>
<% end %>
